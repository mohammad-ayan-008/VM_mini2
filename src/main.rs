#![allow(dead_code)]

mod scanner;
mod vm;
fn main() {
    let mut vm = vm::VM::default();
    let _program = [
        0xF9, 0xFF, 0x01, 0x01, // mov r1, -7
        0x01, 0x00, 0x02, 0x01, // mov r2, 1
        0x00, 0x01, 0x02, 0x02, // add r2,r1
        0x04, 0x00, 0x03, 0x03, // add r3,4 
        0x00, 0x00, 0x00, 0xFF, // halt
    ];

    // a = 10             
    // while a > 0 {   
    //    print(a)
    //    a--;           
    // }                
    
    let loop_program =[
      0x05, 0x00, 0x01 ,0x01,   // MOV r1,5
      0x00, 0x00, 0x02, 0x01,   // MOV r2,0 
      0x00, 0x00, 0x01, 0x11,   // print r1
      0x01, 0x00, 0x01, 0x05,   // SUB r1,1
      0x00, 0x02, 0x01, 0x06,   // CMP r1,r2
      0x02, 0x00, 0x00, 0x09,   // JMPGE 
      0x00, 0x00, 0x00, 0xFF    // HALT
    ];

    vm.copy(&loop_program);

    vm.execute();
}
